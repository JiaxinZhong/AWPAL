<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”</title>
<!--Generated on Wed May 15 17:40:55 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<!--Document created on May 15, 2024.-->

<link rel="stylesheet" href="LaTeXML.css" type="text/css">
<link rel="stylesheet" href="ltx-article.css" type="text/css">
<link rel="stylesheet" href="ltx-listings.css" type="text/css">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet" href="AWPAL.css" type="text/css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jiaxin Zhong
</span></span>
</div>
<div class="ltx_dates">(May 15, 2024)</div>

<nav class="ltx_TOC ltx_list_toc ltx_toc_toc"><h6 class="ltx_title ltx_title_contents">Contents</h6>
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section">
<a href="#S1" title="In Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#S1.SS1" title="In 1 Introduction ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1.1 </span>Installation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a href="#S2" title="In Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Demo Scripts and Core Functions</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a href="#S2.SS1" title="In 2 Demo Scripts and Core Functions ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Direct Integration Method (DIM)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a href="#S2.SS1.SSS1" title="In 2.1 Direct Integration Method (DIM) ‣ 2 Demo Scripts and Core Functions ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.1 </span>Ultrasound Field</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph">
<a href="#S2.SS1.SSS1.P1" title="In 2.1.1 Ultrasound Field ‣ 2.1 Direct Integration Method (DIM) ‣ 2 Demo Scripts and Core Functions ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.1.1 </span>General Solution</span></a>
<ol class="ltx_toclist ltx_toclist_paragraph">
<li class="ltx_tocentry ltx_tocentry_subparagraph"><a href="#S2.SS1.SSS1.P1.SPx1" title="In 2.1.1.1 General Solution ‣ 2.1.1 Ultrasound Field ‣ 2.1 Direct Integration Method (DIM) ‣ 2 Demo Scripts and Core Functions ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title">Function: <span class="ltx_text ltx_lstlisting"><span class="ltx_text ltx_lst_identifier">DIM3D</span>.<span class="ltx_text ltx_lst_identifier">m</span></span></span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a href="#S2.SS1.SSS2" title="In 2.1 Direct Integration Method (DIM) ‣ 2 Demo Scripts and Core Functions ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.2 </span>Audio Sound Field</span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a href="#S2.SS1.SSS2.P1" title="In 2.1.2 Audio Sound Field ‣ 2.1 Direct Integration Method (DIM) ‣ 2 Demo Scripts and Core Functions ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.2.1 </span>General Solution</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsubsection">
<a href="#S2.SS1.SSS3" title="In 2.1 Direct Integration Method (DIM) ‣ 2 Demo Scripts and Core Functions ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.3 </span>Function: <span class="ltx_text ltx_lstlisting"><span class="ltx_text ltx_lst_identifier">PalDIM3D</span>.<span class="ltx_text ltx_lst_identifier">m</span></span></span></a>
<ol class="ltx_toclist ltx_toclist_subsubsection">
<li class="ltx_tocentry ltx_tocentry_paragraph">
<a href="#S2.SS1.SSS3.P1" title="In 2.1.3 Function: PalDIM3D.m ‣ 2.1 Direct Integration Method (DIM) ‣ 2 Demo Scripts and Core Functions ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.3.1 </span>On-Axis</span></a>
<ol class="ltx_toclist ltx_toclist_paragraph">
<li class="ltx_tocentry ltx_tocentry_subparagraph"><a href="#S2.SS1.SSS3.P1.SPx1" title="In 2.1.3.1 On-Axis ‣ 2.1.3 Function: PalDIM3D.m ‣ 2.1 Direct Integration Method (DIM) ‣ 2 Demo Scripts and Core Functions ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title">Demo: <span class="ltx_text ltx_lstlisting"><span class="ltx_text ltx_lst_identifier">PalDIM3D_CircSrc_Axis_Demo</span>.<span class="ltx_text ltx_lst_identifier">m</span></span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subparagraph"><a href="#S2.SS1.SSS3.P1.SPx2" title="In 2.1.3.1 On-Axis ‣ 2.1.3 Function: PalDIM3D.m ‣ 2.1 Direct Integration Method (DIM) ‣ 2 Demo Scripts and Core Functions ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title">Function: <span class="ltx_text ltx_lstlisting"><span class="ltx_text ltx_lst_identifier">PalDIM3D_CircSrc_Axis</span>.<span class="ltx_text ltx_lst_identifier">m</span></span></span></a></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a href="#S2.SS2" title="In 2 Demo Scripts and Core Functions ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Spherical Wave Expansion (SWE)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a href="#S2.SS2.SSS1" title="In 2.2 Spherical Wave Expansion (SWE) ‣ 2 Demo Scripts and Core Functions ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.1 </span>Function: <span class="ltx_text ltx_lstlisting"><span class="ltx_text ltx_lst_identifier">SWE3D_RadialInt</span>.<span class="ltx_text ltx_lst_identifier">m</span></span></span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a href="#S3" title="In Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Summary of Equations</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a href="#S3.SS1" title="In 3 Summary of Equations ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Source Profile</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a href="#S4" title="In Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Known Issues</span></a></li>
</ol></nav>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p class="ltx_p">This document introduces the usage of the code package, which is a supplementary material for the book “Acoustic Waves Generated by Parametric Array Loudspeakers”.
All demos and functions were tested by MATLAB R2022b installed on a personal computer with an AMD Ryzen Threadripper 3960X central processing unit (CPU) with 256 GB of random access memory (RAM).</p>
</div>
<section id="S1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.1 </span>Installation</h3>

<div id="S1.SS1.p1" class="ltx_para">
<p class="ltx_p">Steps:</p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p class="ltx_p">Download all codes from <a href="https://github.com/JiaxinZhong/AWPAL/" title="" class="ltx_ref ltx_href">GitHub: JiaxinZhong/AWPAL</a></p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p class="ltx_p">Run the script AWPAL.m at first to add subfolders to the path.</p>
</div>
</li>
</ol>
</div>
</section>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Demo Scripts and Core Functions</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Direct Integration Method (DIM)</h3>

<section id="S2.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.1 </span>Ultrasound Field</h4>

<section id="S2.SS1.SSS1.P1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">
<span class="ltx_tag ltx_tag_paragraph">2.1.1.1 </span>General Solution</h5>

<section id="S2.SS1.SSS1.P1.SPx1" class="ltx_subparagraph">
<h6 class="ltx_title ltx_title_subparagraph">Function: <span class="ltx_text ltx_lstlisting"><span class="ltx_text ltx_lst_identifier">DIM3D</span>.<span class="ltx_text ltx_lst_identifier">m</span></span>
</h6>

<div id="S2.SS1.SSS1.P1.SPx1.p1" class="ltx_para">
<p class="ltx_p">The calculation utilizes the Rayleigh integral reading that <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="Acoustic waves generated by parametric array loudspeakers (to be published)" class="ltx_ref">1</a>, Eq. (2.39)]</cite></p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1" class="ltx_Math" alttext="p_{i}(\mathbf{r})=\frac{\rho_{0}\omega_{i}}{2\uppi\mathrm{i}}\iint_{-\infty}^{%
\infty}v_{i,z}(\mathbf{r}_{\mathrm{s}})\frac{\mathrm{e}^{\mathrm{i}k_{i}%
\absolutevalue{\mathbf{r}-\mathbf{r}_{\mathrm{s}}}}}{\absolutevalue{\mathbf{r}%
-\mathbf{r}_{\mathrm{s}}}}\differential^{2}\mathbf{r}_{\mathrm{s}}." display="block"><mrow><mrow><mrow><msub><mi>p</mi><mi>i</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐫</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><msub><mi>ρ</mi><mn>0</mn></msub><mo>⁢</mo><msub><mi>ω</mi><mi>i</mi></msub></mrow><mrow><mn>2</mn><mo>⁢</mo><mi mathvariant="normal">π</mi><mo>⁢</mo><mi mathvariant="normal">i</mi></mrow></mfrac><mo>⁢</mo><mrow><msubsup><mo>∬</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></msubsup><mrow><msub><mi>v</mi><mrow><mi>i</mi><mo>,</mo><mi>z</mi></mrow></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐫</mi><mi mathvariant="normal">s</mi></msub><mo stretchy="false">)</mo></mrow><mo>⁢</mo><mfrac><msup><mi mathvariant="normal">e</mi><mrow><mi mathvariant="normal">i</mi><mo>⁢</mo><msub><mi>k</mi><mi>i</mi></msub><mo>⁢</mo><mrow><mo>|</mo><mrow><mi>𝐫</mi><mo>−</mo><msub><mi>𝐫</mi><mi mathvariant="normal">s</mi></msub></mrow><mo>|</mo></mrow></mrow></msup><mrow><mo>|</mo><mrow><mi>𝐫</mi><mo>−</mo><msub><mi>𝐫</mi><mi mathvariant="normal">s</mi></msub></mrow><mo>|</mo></mrow></mfrac><mo lspace="0em">⁢</mo><mrow><msup><mo rspace="0em">d</mo><mn>2</mn></msup><msub><mi>𝐫</mi><mi mathvariant="normal">s</mi></msub></mrow></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
</section>
<section id="S2.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.2 </span>Audio Sound Field</h4>

<section id="S2.SS1.SSS2.P1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">
<span class="ltx_tag ltx_tag_paragraph">2.1.2.1 </span>General Solution</h5>

</section>
</section>
<section id="S2.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.3 </span>Function: <span class="ltx_text ltx_lstlisting"><span class="ltx_text ltx_lst_identifier">PalDIM3D</span>.<span class="ltx_text ltx_lst_identifier">m</span></span>
</h4>

<div id="S2.SS1.SSS3.p1" class="ltx_para">
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1" class="ltx_Math" alttext="p_{\mathrm{a}}(\mathbf{r})=-\frac{\beta\omega_{\mathrm{a}}^{2}}{4\uppi\rho_{0}%
c_{0}^{4}}\iiint_{-\infty}^{\infty}\frac{p_{1}^{*}(\mathbf{r}_{\mathrm{v}})p_{%
2}(\mathbf{r}_{\mathrm{v}})}{\absolutevalue{\mathbf{r}-\mathbf{r}_{\mathrm{v}}%
}}\mathrm{e}^{\mathrm{i}k_{\mathrm{a}}\absolutevalue{\mathbf{r}-\mathbf{r}_{%
\mathrm{v}}}}\differential^{3}\mathbf{r}_{\mathrm{v}}." display="block"><mrow><mrow><mrow><msub><mi>p</mi><mi mathvariant="normal">a</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mi>𝐫</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>−</mo><mrow><mfrac><mrow><mi>β</mi><mo>⁢</mo><msubsup><mi>ω</mi><mi mathvariant="normal">a</mi><mn>2</mn></msubsup></mrow><mrow><mn>4</mn><mo>⁢</mo><mi mathvariant="normal">π</mi><mo>⁢</mo><msub><mi>ρ</mi><mn>0</mn></msub><mo>⁢</mo><msubsup><mi>c</mi><mn>0</mn><mn>4</mn></msubsup></mrow></mfrac><mo>⁢</mo><mrow><msubsup><mo>∭</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></msubsup><mrow><mfrac><mrow><msubsup><mi>p</mi><mn>1</mn><mo>∗</mo></msubsup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐫</mi><mi mathvariant="normal">v</mi></msub><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msub><mi>p</mi><mn>2</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐫</mi><mi mathvariant="normal">v</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mrow><mo>|</mo><mrow><mi>𝐫</mi><mo>−</mo><msub><mi>𝐫</mi><mi mathvariant="normal">v</mi></msub></mrow><mo>|</mo></mrow></mfrac><mo>⁢</mo><msup><mi mathvariant="normal">e</mi><mrow><mi mathvariant="normal">i</mi><mo>⁢</mo><msub><mi>k</mi><mi mathvariant="normal">a</mi></msub><mo>⁢</mo><mrow><mo>|</mo><mrow><mi>𝐫</mi><mo>−</mo><msub><mi>𝐫</mi><mi mathvariant="normal">v</mi></msub></mrow><mo>|</mo></mrow></mrow></msup><mo lspace="0em">⁢</mo><mrow><msup><mo rspace="0em">d</mo><mn>3</mn></msup><msub><mi>𝐫</mi><mi mathvariant="normal">v</mi></msub></mrow></mrow></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<section id="S2.SS1.SSS3.P1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">
<span class="ltx_tag ltx_tag_paragraph">2.1.3.1 </span>On-Axis</h5>

<section id="S2.SS1.SSS3.P1.SPx1" class="ltx_subparagraph">
<h6 class="ltx_title ltx_title_subparagraph">Demo: <span class="ltx_text ltx_lstlisting"><span class="ltx_text ltx_lst_identifier">PalDIM3D_CircSrc_Axis_Demo</span>.<span class="ltx_text ltx_lst_identifier">m</span></span>
</h6>

<div id="S2.SS1.SSS3.P1.SPx1.p1" class="ltx_para">
<p class="ltx_p">Figure <a href="#S2.F1" title="Figure 1 ‣ Demo: PalDIM3D_CircSrc_Axis_Demo.m ‣ 2.1.3.1 On-Axis ‣ 2.1.3 Function: PalDIM3D.m ‣ 2.1 Direct Integration Method (DIM) ‣ 2 Demo Scripts and Core Functions ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> is generated by this demo file.
The data is stored in file <span class="ltx_text ltx_lstlisting"><span class="ltx_text ltx_lst_identifier">PalDIM3D_CircSrc_Axis_Demo_Uniform</span>.<span class="ltx_text ltx_lst_identifier">mat</span></span>.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="x4.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="359" height="277" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>On-axial SPL (dB) as a function of the axial distance (<math id="S2.F1.m3" class="ltx_Math" alttext="z" display="inline"><mi>z</mi></math>, m) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="Low frequency audio sound field generated by a focusing parametric array loudspeaker" class="ltx_ref">2</a>, Fig. 2(d)]</cite>.
The PAL has a circular uniform profile with a radius of <math id="S2.F1.m4" class="ltx_Math" alttext="a=0.1\,\mathrm{m}" display="inline"><mrow><mi>a</mi><mo>=</mo><mrow><mn>0.1</mn><mo lspace="0.170em">⁢</mo><mi mathvariant="normal">m</mi></mrow></mrow></math>.
</figcaption>
</figure>
<div id="S2.SS1.SSS3.P1.SPx1.p2" class="ltx_para">
<p class="ltx_p">Figure <a href="#S2.F2" title="Figure 2 ‣ Demo: PalDIM3D_CircSrc_Axis_Demo.m ‣ 2.1.3.1 On-Axis ‣ 2.1.3 Function: PalDIM3D.m ‣ 2.1 Direct Integration Method (DIM) ‣ 2 Demo Scripts and Core Functions ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> is generated by this demo file.
The data is stored in file <span class="ltx_text ltx_lstlisting"><span class="ltx_text ltx_lst_identifier">PalDIM3D_CircSrc_Axis_Demo_Focus</span>.<span class="ltx_text ltx_lst_identifier">mat</span></span>.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="x3.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="359" height="277" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>On-axial SPL (dB) as a function of the axial distance (<math id="S2.F2.m4" class="ltx_Math" alttext="z" display="inline"><mi>z</mi></math>, m) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="Low frequency audio sound field generated by a focusing parametric array loudspeaker" class="ltx_ref">2</a>, Fig. 2(e)]</cite>.
The PAL has a focusing profile with a focal distance of <math id="S2.F2.m5" class="ltx_Math" alttext="r_{\mathrm{f}}=0.2\,{m}" display="inline"><mrow><msub><mi>r</mi><mi mathvariant="normal">f</mi></msub><mo>=</mo><mrow><mn>0.2</mn><mo lspace="0.170em">⁢</mo><mi>m</mi></mrow></mrow></math>.
The radius of the PAL is <math id="S2.F2.m6" class="ltx_Math" alttext="a=0.1\,\mathrm{m}" display="inline"><mrow><mi>a</mi><mo>=</mo><mrow><mn>0.1</mn><mo lspace="0.170em">⁢</mo><mi mathvariant="normal">m</mi></mrow></mrow></math>.
</figcaption>
</figure>
</section>
<section id="S2.SS1.SSS3.P1.SPx2" class="ltx_subparagraph">
<h6 class="ltx_title ltx_title_subparagraph">Function: <span class="ltx_text ltx_lstlisting"><span class="ltx_text ltx_lst_identifier">PalDIM3D_CircSrc_Axis</span>.<span class="ltx_text ltx_lst_identifier">m</span></span>
</h6>

<div id="S2.SS1.SSS3.P1.SPx2.p1" class="ltx_para">
<p class="ltx_p">Calculate the audio sound field on the axis <math id="S2.SS1.SSS3.P1.SPx2.p1.m1" class="ltx_Math" alttext="\rho=0" display="inline"><mrow><mi>ρ</mi><mo>=</mo><mn>0</mn></mrow></math> using the DIM.
The source profile is assumed to be axisymmetric in the azimuthal direction, i.e., <math id="S2.SS1.SSS3.P1.SPx2.p1.m2" class="ltx_Math" alttext="v_{i,z}(\mathbf{r}_{\mathrm{s}})" display="inline"><mrow><msub><mi>v</mi><mrow><mi>i</mi><mo>,</mo><mi>z</mi></mrow></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐫</mi><mi mathvariant="normal">s</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math> is independent of <math id="S2.SS1.SSS3.P1.SPx2.p1.m3" class="ltx_Math" alttext="\varphi_{\mathrm{s}}" display="inline"><msub><mi>φ</mi><mi mathvariant="normal">s</mi></msub></math>.
The formula used in this function is</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1" class="ltx_Math" alttext="p_{\mathrm{a}}(\rho=0,\varphi,z)=-\frac{\beta\omega_{\mathrm{a}}^{2}}{2\rho_{0%
}c_{0}^{4}}\int_{-\infty}^{\infty}\int_{0}^{\infty}\frac{p_{1}^{*}(\mathbf{r}_%
{\mathrm{v}})p_{2}(\mathbf{r}_{\mathrm{v}})}{\sqrt{\rho_{\mathrm{v}}^{2}+(z-z_%
{\mathrm{v}})^{2}}}\mathrm{e}^{\mathrm{i}k_{\mathrm{a}}\sqrt{\rho_{\mathrm{v}}%
^{2}+(z-z_{\mathrm{v}})^{2}}}\rho_{\mathrm{v}}\differential\rho_{\mathrm{v}}%
\differential z_{\mathrm{v}}" display="block"><mrow><mrow><msub><mi>p</mi><mi mathvariant="normal">a</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ρ</mi><mo>=</mo><mrow><mn>0</mn><mo>,</mo><mi>φ</mi><mo>,</mo><mi>z</mi></mrow></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mo>−</mo><mrow><mfrac><mrow><mi>β</mi><mo>⁢</mo><msubsup><mi>ω</mi><mi mathvariant="normal">a</mi><mn>2</mn></msubsup></mrow><mrow><mn>2</mn><mo>⁢</mo><msub><mi>ρ</mi><mn>0</mn></msub><mo>⁢</mo><msubsup><mi>c</mi><mn>0</mn><mn>4</mn></msubsup></mrow></mfrac><mo>⁢</mo><mrow><msubsup><mo rspace="0em">∫</mo><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></msubsup><mrow><msubsup><mo>∫</mo><mn>0</mn><mi mathvariant="normal">∞</mi></msubsup><mrow><mfrac><mrow><msubsup><mi>p</mi><mn>1</mn><mo>∗</mo></msubsup><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐫</mi><mi mathvariant="normal">v</mi></msub><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msub><mi>p</mi><mn>2</mn></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐫</mi><mi mathvariant="normal">v</mi></msub><mo stretchy="false">)</mo></mrow></mrow><msqrt><mrow><msubsup><mi>ρ</mi><mi mathvariant="normal">v</mi><mn>2</mn></msubsup><mo>+</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo>−</mo><msub><mi>z</mi><mi mathvariant="normal">v</mi></msub></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></msqrt></mfrac><mo>⁢</mo><msup><mi mathvariant="normal">e</mi><mrow><mi mathvariant="normal">i</mi><mo>⁢</mo><msub><mi>k</mi><mi mathvariant="normal">a</mi></msub><mo>⁢</mo><msqrt><mrow><msubsup><mi>ρ</mi><mi mathvariant="normal">v</mi><mn>2</mn></msubsup><mo>+</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>z</mi><mo>−</mo><msub><mi>z</mi><mi mathvariant="normal">v</mi></msub></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></msqrt></mrow></msup><mo>⁢</mo><msub><mi>ρ</mi><mi mathvariant="normal">v</mi></msub><mo lspace="0em">⁢</mo><mrow><mo rspace="0em">d</mo><mrow><msub><mi>ρ</mi><mi mathvariant="normal">v</mi></msub><mo lspace="0em">⁢</mo><mrow><mo rspace="0em">d</mo><msub><mi>z</mi><mi mathvariant="normal">v</mi></msub></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
</section>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Spherical Wave Expansion (SWE)</h3>

<section id="S2.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.1 </span>Function: <span class="ltx_text ltx_lstlisting"><span class="ltx_text ltx_lst_identifier">SWE3D_RadialInt</span>.<span class="ltx_text ltx_lst_identifier">m</span></span>
</h4>

<div id="S2.SS2.SSS1.p1" class="ltx_para">
<p class="ltx_p">Calculate</p>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1" class="ltx_Math" alttext="\int_{r_{1}}^{r_{2}}\mathrm{j}_{n}(kr_{&lt;})\mathrm{h}_{n}(kr_{&gt;})r_{\mathrm{s}}%
\differential r_{\mathrm{s}}" display="block"><mrow><msubsup><mo>∫</mo><msub><mi>r</mi><mn>1</mn></msub><msub><mi>r</mi><mn>2</mn></msub></msubsup><mrow><msub><mi mathvariant="normal">j</mi><mi>n</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>k</mi><mo>⁢</mo><msub><mi>r</mi><mo>&lt;</mo></msub></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msub><mi mathvariant="normal">h</mi><mi>n</mi></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>k</mi><mo>⁢</mo><msub><mi>r</mi><mo>&gt;</mo></msub></mrow><mo stretchy="false">)</mo></mrow><mo>⁢</mo><msub><mi>r</mi><mi mathvariant="normal">s</mi></msub><mo lspace="0em">⁢</mo><mrow><mo rspace="0em">d</mo><msub><mi>r</mi><mi mathvariant="normal">s</mi></msub></mrow></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math id="S2.SS2.SSS1.p1.m1" class="ltx_Math" alttext="r_{&lt;}=\min(r,r_{\mathrm{s}})" display="inline"><mrow><msub><mi>r</mi><mo>&lt;</mo></msub><mo>=</mo><mrow><mi>min</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mi>r</mi><mo>,</mo><msub><mi>r</mi><mi mathvariant="normal">s</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></math> and <math id="S2.SS2.SSS1.p1.m2" class="ltx_Math" alttext="r_{&gt;}=\max(r,r_{\mathrm{s}})" display="inline"><mrow><msub><mi>r</mi><mo>&gt;</mo></msub><mo>=</mo><mrow><mi>max</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mi>r</mi><mo>,</mo><msub><mi>r</mi><mi mathvariant="normal">s</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></math>.</p>
</div>
</section>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Summary of Equations</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Source Profile</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p class="ltx_p">The focusing profile reads</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1" class="ltx_Math" alttext="v_{i,z}(\mathbf{r}_{\mathrm{s}})=v_{0}\exp\quantity(-\mathrm{i}\Re(k_{i})%
\absolutevalue{\mathbf{r}_{\mathrm{f}}-\mathbf{r}_{\mathrm{s}}})." display="block"><mrow><mrow><mrow><msub><mi>v</mi><mrow><mi>i</mi><mo>,</mo><mi>z</mi></mrow></msub><mo>⁢</mo><mrow><mo stretchy="false">(</mo><msub><mi>𝐫</mi><mi mathvariant="normal">s</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msub><mi>v</mi><mn>0</mn></msub><mo lspace="0.167em">⁢</mo><mrow><mi>exp</mi><mo>⁡</mo><mrow><mo>(</mo><mrow><mo>−</mo><mrow><mi mathvariant="normal">i</mi><mo lspace="0.167em">⁢</mo><mrow><mi mathvariant="normal">ℜ</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>⁢</mo><mrow><mo>|</mo><mrow><msub><mi>𝐫</mi><mi mathvariant="normal">f</mi></msub><mo>−</mo><msub><mi>𝐫</mi><mi mathvariant="normal">s</mi></msub></mrow><mo>|</mo></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math id="S3.SS1.p1.m1" class="ltx_Math" alttext="\mathbf{r}_{\mathrm{f}}" display="inline"><msub><mi>𝐫</mi><mi mathvariant="normal">f</mi></msub></math> denotes the location of the focal point.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Known Issues</h2>

</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul id="bib.L1" class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem ltx_bib_book">
<span class="ltx_tag ltx_bib_key ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_author">J. Zhong and X. Qiu</span><span class="ltx_text ltx_bib_year"> (2024)</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_title">Acoustic waves generated by parametric array loudspeakers (to be published)</span>.
</span>
<span class="ltx_bibblock"> <span class="ltx_text ltx_bib_publisher">CRC Press</span>.
</span>
<span class="ltx_bibblock ltx_bib_cited">Cited by: <a href="#S2.SS1.SSS1.P1.SPx1.p1" title="Function: DIM3D.m ‣ 2.1.1.1 General Solution ‣ 2.1.1 Ultrasound Field ‣ 2.1 Direct Integration Method (DIM) ‣ 2 Demo Scripts and Core Functions ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_tag">¶2.1.1.1</span></a>.
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem ltx_bib_article">
<span class="ltx_tag ltx_bib_key ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_author">J. Zhong, T. Zhuang, R. Kirby, M. Karimi, X. Qiu, H. Zou, and J. Lu</span><span class="ltx_text ltx_bib_year"> (2022)</span>
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_title">Low frequency audio sound field generated by a focusing parametric array loudspeaker</span>.
</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_bib_journal">IEEE/ACM Trans. Audio Speech Lang. Process.</span> <span class="ltx_text ltx_bib_volume">30</span>, <span class="ltx_text ltx_bib_pages"> pp. 3098–3109</span>.
</span>
<span class="ltx_bibblock">External Links: <span class="ltx_text ltx_bib_links"><span class="ltx_text issn ltx_bib_external">ISSN 0001-4966</span>,
<a href="https://dx.doi.org/10.1109/TASLP.2022.3209944" title="" class="ltx_ref doi ltx_bib_external">Document</a></span>
</span>
<span class="ltx_bibblock ltx_bib_cited">Cited by: <a href="#S2.F1" title="In Demo: PalDIM3D_CircSrc_Axis_Demo.m ‣ 2.1.3.1 On-Axis ‣ 2.1.3 Function: PalDIM3D.m ‣ 2.1 Direct Integration Method (DIM) ‣ 2 Demo Scripts and Core Functions ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure 1</span></a>,
<a href="#S2.F2" title="In Demo: PalDIM3D_CircSrc_Axis_Demo.m ‣ 2.1.3.1 On-Axis ‣ 2.1.3 Function: PalDIM3D.m ‣ 2.1 Direct Integration Method (DIM) ‣ 2 Demo Scripts and Core Functions ‣ Manual on the Code of the Book Entitled “Acoustic Waves Generated by Parametric Array Loudspeakers”" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure 2</span></a>.
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed May 15 17:40:55 2024 by <a href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>
</body>
</html>
